# Excel模板设计文档

## 概述

新的Excel模板设计包含了完整的词典单词字段，支持用户上传包含详细信息的单词数据。

## 模板结构

### 工作表组成

1. **单词数据** - 主要的数据输入工作表
2. **使用说明** - 详细的字段说明和使用指南

### 字段设计

#### 必填字段
- **单词** (word) - 英文单词名称

#### 选填字段

**音标字段**
- **美式音标** (usphone) - 美式发音音标
- **英式音标** (ukphone) - 英式发音音标

**翻译字段（支持最多2个词性）**
- **词性1** (pos1) - 第一个词性 (n/v/adj/adv等)
- **中文释义1** (chinese1) - 第一个中文含义
- **英文释义1** (english1) - 第一个英文解释
- **词性2** (pos2) - 第二个词性
- **中文释义2** (chinese2) - 第二个中文含义
- **英文释义2** (english2) - 第二个英文解释

**例句字段（支持最多2个例句）**
- **例句1英文** (sentence1_en) - 第一个英文例句
- **例句1中文** (sentence1_cn) - 第一个例句的中文翻译
- **例句2英文** (sentence2_en) - 第二个英文例句
- **例句2中文** (sentence2_cn) - 第二个例句的中文翻译

## 模板布局

### 第1行：中文列名（含必填/选填标记）
显示用户友好的中文字段名称，如：单词【必填】、美式音标【选填】

### 第2行：英文列名
程序识别用的英文字段名称

### 第3行开始：示例数据
提供3个完整的示例单词数据

## 兼容性

### 向后兼容
- 支持旧格式的字段名：word, translation, phonetic
- 自动识别并转换旧格式数据

### 智能解析
- 自动跳过说明行，识别实际数据起始位置
- 支持中英文字段名混用
- 容错处理，忽略空白字段

## 使用指南

### 用户操作流程
1. 下载Excel模板
2. 查看"使用说明"工作表了解字段要求
3. 在"单词数据"工作表中填写数据
4. 上传Excel文件到系统

### 填写建议
- 只有"单词"字段是必填的
- 其他字段可根据需要选择性填写
- 可以先只填写单词名称，后续通过编辑功能完善
- 支持批量导入基础单词列表

## 技术实现

### 模板生成
- 使用 `generateExcelTemplate()` 函数生成
- 包含完整的字段结构和示例数据
- 自动设置列宽优化显示效果

### 表格结构
```
A1: 单词【必填】    B1: 美式音标【选填】  C1: 英式音标【选填】  D1: 词性1【选填】  ...
A2: word           B2: usphone          C2: ukphone          D2: pos1          ...
A3: apple          B3: ˈæpl             C3: ˈæpəl            D3: n             ...
```

### 数据解析
- 使用 `validateAndConvertData()` 函数解析
- 智能识别数据起始位置
- 支持多种字段名格式
- 详细的错误提示和验证

### 数据转换
- 转换为 `ICustomWord` 格式
- 自动构建 `userData` 结构
- 设置正确的 `sourceType` 和状态标识

## 示例数据

```
单词: apple
美式音标: ˈæpl
英式音标: ˈæpəl
词性1: n
中文释义1: 苹果
英文释义1: a round fruit with red or green skin
例句1英文: I eat an apple every day.
例句1中文: 我每天吃一个苹果。
```

## 优势

1. **完整性** - 支持所有词典字段
2. **灵活性** - 必填字段最少，选填字段丰富
3. **易用性** - 中英文双语说明，示例丰富
4. **兼容性** - 支持旧格式，平滑升级
5. **扩展性** - 可轻松添加新字段

## 注意事项

- Excel文件编码建议使用UTF-8
- 建议使用最新版本的Excel或WPS
- 大文件上传时注意网络稳定性
- 数据验证失败时查看详细错误信息
